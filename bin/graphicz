#!/usr/bin/env ruby

require 'highline/import'
require_relative '../command'

$image = []

def print_image
  puts $image.map { |pixels| pixels.join }.join("\n")
end

def create(width,height)
  $image = []
  height.times { $image.push(Array.new(width, 'O')) }
end

def color(x,y,color)
  $image[y-1][x-1] = color
end


loop do
  begin
    command = ask("Enter a command: ", Command)

    case command.instruction
    when :new_image
      create(command.row, command.column)
    when :color_pixel
      color(command.row, command.column, command.color)
    when :clear_image
      create($image[0].length, $image.length)
    when :show_image
      print_image
    when :quit
      break
    end

  rescue EOFError
    break
  end
end

puts "\n"
exit
